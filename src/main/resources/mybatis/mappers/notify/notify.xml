<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
<mapper namespace = "notify">

	<resultMap id ="notifyResult01" type = "NotifyVO">
		<result property = "not_Num" column = "not_Num"/>
		<result property = "i_Num" column = "i_Num"/>
		<result property = "not_Status" column = "not_Status"/>
		<result property = "not_Kind" column = "not_Kind"/>
		<result property = "mem_Id" column = "mem_Id"/>
		<result property = "c_Id" column = "c_Id"/>
		
	</resultMap>
	<resultMap id ="notifyResult02" type = "java.util.Map">
		<result property = "not_Num" column = "not_Num"/>
		<result property = "i_Num" column = "i_Num"/>
		<result property = "not_Status" column = "not_Status"/>
		<result property = "not_Kind" column = "not_Kind"/>
		<result property = "mem_Id" column = "mem_Id"/>
		<result property = "c_Id" column = "c_Id"/>
		<result property = "i_Date" column = "i_Date"/>
		<result property = "i_Content" column = "i_Content" jdbcType="CLOB" javaType="java.lang.String"/>
		
	</resultMap>
	
	<select id="viewNotify" resultMap = "notifyResult02" parameterType="java.util.Map">
	<![CDATA[
          select not_Num, i_Num, not_Status, not_Kind, mem_Id, c_Id 
              from notify
              where not_Status = '0'
              and mem_Id = #{mem_Id}         
      ]]>
		 
			     
			
	</select>
	
	
	<select id = "searchNotify" resultMap = "notifyResult02" parameterType = "java.util.Map">
	<![CDATA[
	select i.i_Date, i.mem_Id, i.i_Content, i.i_Num, i.c_Id
from issue i , notify n 
where i.i_Num = n.i_num
and n.mem_Id = #{mem_Id}
and n.not_status = '0'
	]]>
	
	</select>
 
 <insert id="notifyInsert" parameterType = "java.util.Map">
<![CDATA[
	insert into notify(not_Num, i_Num, not_Status, not_Kind, mem_Id, c_Id)
    select notify_seq.nextval,#{i_Num},'0','',mem_Id,c_Id 
    from co_member
    where c_Id = #{c_Id}
    and mem_Id not in #{mem_Id}
   
	]]>
	</insert>
	
	<update id ="notifyUpdate" parameterType = "java.util.Map">
	<![CDATA[
	update notify set not_Status = '1'
	where i_Num = #{i_Num}
	and mem_Id = #{mem_Id}
	  ]]>
	  
	</update>

</mapper>