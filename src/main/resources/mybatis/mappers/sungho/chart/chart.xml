<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="chart">
	<resultMap id="chartResult01" type="java.util.Map">
		<result property="mem_Count" column="mem_Count" />
		<result property="mem_Joindate" column="mem_Joindate" />
		<result property="dayitem" column="dayitem" />
		<result property="cnt" column="cnt" />
	</resultMap>

	<select id="searchList" resultMap="chartResult01"
		parameterType="java.util.Map"> 
      <![CDATA[
         SELECT dayitem,
       NVL((
        SELECT mem_Count
        FROM
        (
        select count(*) as mem_Count, mem_Joindate
        from member
        where to_date(mem_Joindate) BETWEEN  sysdate-6   AND  sysdate
        GROUP BY mem_Joindate
        )
        WHERE mem_Joindate = A.dayitem
       ),0) AS CNT
FROM(
    SELECT to_char(sysdate-6) AS dayitem FROM dual UNION all
    SELECT to_char(sysdate-5) AS dayitem FROM dual UNION all
    SELECT to_char(sysdate-4) AS dayitem FROM dual UNION all
    SELECT to_char(sysdate-3) AS dayitem FROM dual UNION all
    SELECT to_char(sysdate-2) AS dayitem FROM dual UNION all
    SELECT to_char(sysdate-1) AS dayitem FROM dual UNION all
    SELECT to_char(sysdate) AS dayitem FROM dual  
) A
      ]]>
	</select>
	<select id="memCount" resultType="int">
      <![CDATA[
         select count(*) from member
      ]]>
	</select>
	

	<select id="donutList" resultMap="chartResult01" parameterType="java.util.Map">
      <![CDATA[
        select count(*) as cnt, c_category
		from co_work group by c_category
		order by c_category asc
      ]]>
	</select>
	
</mapper>